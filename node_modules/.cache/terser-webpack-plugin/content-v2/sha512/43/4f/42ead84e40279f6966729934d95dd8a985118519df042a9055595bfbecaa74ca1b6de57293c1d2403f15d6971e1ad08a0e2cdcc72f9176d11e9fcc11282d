{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{398:function(a,t,s){\"use strict\";s.r(t);var r=s(42),e=Object(r.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":a.$parent.slotKey}},[s(\"h3\",{attrs:{id:\"集群部署\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#集群部署\"}},[a._v(\"#\")]),a._v(\" 集群部署\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"集群提供可扩展的容量，且高可用，并发处理高，生产环境应用运行在集群中\")])]),a._v(\" \"),s(\"h4\",{attrs:{id:\"windows集群\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#windows集群\"}},[a._v(\"#\")]),a._v(\" Windows集群\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"linux集群\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#linux集群\"}},[a._v(\"#\")]),a._v(\" Linux集群\")]),a._v(\" \"),s(\"h3\",{attrs:{id:\"es核心\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#es核心\"}},[a._v(\"#\")]),a._v(\" ES核心\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"接近实时-nrt\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#接近实时-nrt\"}},[a._v(\"#\")]),a._v(\" 接近实时 NRT\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"ES是一个接近实时的搜索平台，这意味着，从索引一个文档直到这个文档能够被搜索到有一个轻微的延迟（1s以内）\")])]),a._v(\" \"),s(\"h4\",{attrs:{id:\"集群-cluster\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#集群-cluster\"}},[a._v(\"#\")]),a._v(\" 集群 cluster\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"一个集群就是由一个或者多个节点组织一起的，它们共同持有整个数据，并提供索引和搜索功能。一个集群由一个唯一的名字来标识，这个名字默认‘elactisearch’,这个名字是重要的，因为节点的加入必须指定某个集群的名字。\")])]),a._v(\" \"),s(\"h4\",{attrs:{id:\"节点-node\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#节点-node\"}},[a._v(\"#\")]),a._v(\" 节点 node\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"集群包含多个节点，它参与集群的索引和搜索功能\")]),a._v(\" \"),s(\"li\",[a._v(\"节点也是有名称的，默认情况下是一个随机的漫威角色名，这个名字会在节点启动时赋予。节点名称对于管理也是重要的，在管理过程中，需要确定网络中哪些服务器对于集群中的哪些节点。\")]),a._v(\" \"),s(\"li\",[a._v(\"一个节点可以通过配置集群名称加入集群，如果你启动了若干节点，并假定它们彼此互相发现，那么它们就自动的形成并加入集群中。\")])]),a._v(\" \"),s(\"h4\",{attrs:{id:\"分片-shards\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#分片-shards\"}},[a._v(\"#\")]),a._v(\" 分片 shards\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"分片：\\n\"),s(\"ul\",[s(\"li\",[a._v(\"分片就是，有一个大的索引，单节点没有这么大容量或者放单节点上处理搜索很慢，为了解决这个问题，es设置分片，允许一个索引放置在多个节点上。\")]),a._v(\" \"),s(\"li\",[a._v(\"分片很重要，主要的原因有两个：1）允许你水平分割/拓展你的内容容量 2）允许你分片(潜在地位于多个节点上)之上进行分布式，并行的操作，提高吞吐量\")])])])]),a._v(\" \"),s(\"h4\",{attrs:{id:\"副本-replicas\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#副本-replicas\"}},[a._v(\"#\")]),a._v(\" 副本 replicas\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"在一个网络、云环境中，失败随时可能发生，在某个分片/节点挂掉时，有一个故障转移机制是非常有用的\")])]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"某个节点挂了，有一个故障转移很重要。为此目的，ES允许你创建分片的一份或多份拷贝，这些拷贝叫做复制分片，或者复制\")]),a._v(\" \"),s(\"li\",[a._v(\"复制很重要，主要的原因有两个：1）在节点失败的情况下，提供了高可用 2）拓展搜索量/吞吐量\")]),a._v(\" \"),s(\"li\",[a._v(\"复制不与原分片/主要分片置于同一节点是重要的\")])]),a._v(\" \"),s(\"h4\",{attrs:{id:\"分配-allocation\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#分配-allocation\"}},[a._v(\"#\")]),a._v(\" 分配 allocation\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"将分片分配给某个节点的过程，包括分配主分片或者副本。如果是副本，还包含从主分片复制数据的过程。这个过程是由master节点完成的\")])]),a._v(\" \"),s(\"h4\",{attrs:{id:\"系统架构\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#系统架构\"}},[a._v(\"#\")]),a._v(\" 系统架构\")]),a._v(\" \"),s(\"img\",{attrs:{src:a.$withBase(\"/es/es.png\"),alt:\"dock\"}}),a._v(\" \"),s(\"div\",{staticClass:\"language-sh extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[a._v(\"# 假设我们设置一个users的索引,设置三个分片，每个分片对应一个副本\")]),a._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"curl\")]),a._v(\" -XPUT \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"http://localhost:9200/users/_settings\"')]),a._v(\" -d\"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\\'\\n{\\n  \"settings\":{\\n    \"number_of_shards:\": 3,\\n    \"number_of_replicas\": 1\\n  }\\n}\\n\\'')]),a._v(\"\\n\")])])]),s(\"h4\",{attrs:{id:\"故障转移\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#故障转移\"}},[a._v(\"#\")]),a._v(\" 故障转移\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"当集群只有一个节点时，意味着会有单点故障问题。\\n\"),s(\"ul\",[s(\"li\",[a._v(\"当你在同一台集群启动另一个节点，只要第二个节点具有相同的cluster.name,它会自动发现加入。\")]),a._v(\" \"),s(\"li\",[a._v(\"在不同机器上启动节点，为了加入集群，需要配置一个可连接到单播主机列表。之所以配置为使用单播发现，是防止其它节点无意中加入集群\")])])])]),a._v(\" \"),s(\"h4\",{attrs:{id:\"水平扩容\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#水平扩容\"}},[a._v(\"#\")]),a._v(\" 水平扩容\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"水平扩容，当启动三个节点，为了分散负载会对分片进行重新分片\\n\"),s(\"ul\",[s(\"li\",[a._v(\"如果是一个或两个节点，三个分片每个节点都会有，当节点为三个，则三个分片会两两分配到三个节点上，保证每个节点上，任意一个分片异常，都有别的节点上副本提供备用\")])])])]),a._v(\" \"),s(\"div\",{staticClass:\"custom-block tip\"},[s(\"p\",{staticClass:\"custom-block-title\"},[a._v(\"TIP\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"假设三个分片0、1、2，三个节点A、B、C\\n\"),s(\"ul\",[s(\"li\",[a._v(\"A节点上分片 0、1\")]),a._v(\" \"),s(\"li\",[a._v(\"B节点上分片 0、2\")]),a._v(\" \"),s(\"li\",[a._v(\"C节点上分片 1、2\")])])])])]),a._v(\" \"),s(\"ul\",[s(\"li\",[s(\"p\",[a._v(\"分片是一个功能完整的搜索引擎，它拥有使用的一个节点上所有资源的能力。我们现在拥有6个节点（3主分片，3副本分片）的索引最大可扩展到6个节点，每个节点上一个分片，并且每个分片拥有所在节点的全部资源。\")])]),a._v(\" \"),s(\"li\",[s(\"p\",[a._v(\"如果我们想扩容超过6个节点怎么办？\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"主分片数目在索引创建时已经确定了（不可变），只有3个。这个定义的数目已经确定了数据存储的最大量（取决数据大小、硬件大小、使用场景）。但是读操作，是可以同时从主分片和副本分片处理。意味着，你可以扩展大的副本节点，使吞吐量变大\")])])])]),a._v(\" \"),s(\"div\",{staticClass:\"language-sh extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[a._v(\"#条件副本分片为2，即三个分片拥有6个副本\")]),a._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"curl\")]),a._v(\" -XPUT \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"http://localhost:9200/users/_settings\"')]),a._v(\" -d\"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"'\\n{\\n  \\\"number_of_replicas\\\":2\\n}\\n'\")]),a._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[a._v(\"# 这种情况下，极限节点数就是9台，3主+6副本\")]),a._v(\"\\n\")])])]),s(\"h4\",{attrs:{id:\"应对故障\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#应对故障\"}},[a._v(\"#\")]),a._v(\" 应对故障\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"路由计算-分片控制\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#路由计算-分片控制\"}},[a._v(\"#\")]),a._v(\" 路由计算&分片控制\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"数据写流程\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#数据写流程\"}},[a._v(\"#\")]),a._v(\" 数据写流程\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"数据读流程\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#数据读流程\"}},[a._v(\"#\")]),a._v(\" 数据读流程\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"更新流程-批量操作流程\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#更新流程-批量操作流程\"}},[a._v(\"#\")]),a._v(\" 更新流程&批量操作流程\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"倒排索引\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#倒排索引\"}},[a._v(\"#\")]),a._v(\" 倒排索引\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"文档搜索\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#文档搜索\"}},[a._v(\"#\")]),a._v(\" 文档搜索\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"文档刷新-文档刷写-文档合并\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#文档刷新-文档刷写-文档合并\"}},[a._v(\"#\")]),a._v(\" 文档刷新&文档刷写&文档合并\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"文档分析\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#文档分析\"}},[a._v(\"#\")]),a._v(\" 文档分析\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"文档控制\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#文档控制\"}},[a._v(\"#\")]),a._v(\" 文档控制\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"文档展示-kibana\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#文档展示-kibana\"}},[a._v(\"#\")]),a._v(\" 文档展示-kibana\")])])}),[],!1,null,null,null);t.default=e.exports}}]);","extractedComments":[]}